<div class="w-full">
  <h2 class="text-2xl font-semibold mb-6 text-center">Select Your Interests</h2>
  
  <div class="mb-6">
    <p class="text-center text-gray-600 mb-2">Select at least 3 topics that interest you</p>
    <p class="text-center text-sm" [class.text-success]="hasMinimumTags" [class.text-error]="!hasMinimumTags">
      {{ selectedTags.length }} selected (Minimum: 3)
    </p>
  </div>
  
  <!-- Search Input -->
  <form [formGroup]="tagsForm" class="mb-6">
    <div class="form-control w-full max-w-lg mx-auto">
      <label class="label">
        <span class="label-text">Search for topics</span>
      </label>
      <input type="text" formControlName="tagInput" class="input input-bordered w-full" placeholder="Type to search..." />
    </div>
  </form>
  
  <!-- Loading State -->
  @if (isLoading) {
    <div class="flex justify-center my-8">
      <fa-icon [icon]="['fas', 'spinner']" class="fa-spin text-primary" size="3x"></fa-icon>
    </div>
  }
  
  <!-- Tags Selection Grid -->
  @if (!isLoading) {
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-8">
      @for (tag of availableTags; track tag.id) {
        <div 
          (click)="toggleTagSelection(tag.id)"
          class="badge badge-lg p-4 cursor-pointer"
          [class.badge-primary]="isTagSelected(tag.id)"
          [class.badge-outline]="!isTagSelected(tag.id)">
          {{ tag.name }}
        </div>
      }
    </div>
  }
  
  <!-- Save Button -->
  <div class="flex justify-center mt-6">
    <button 
      (click)="saveTags()" 
      class="btn btn-primary" 
      [disabled]="!hasMinimumTags || isSaving">
      @if (isSaving) {
        <fa-icon [icon]="['fas', 'spinner']" class="fa-spin mr-2"></fa-icon>
      }
      {{ isSaving ? 'Saving...' : 'Save Interests' }}
    </button>
  </div>
  
  <!-- Guide Text -->
  <div class="mt-8 text-center text-sm text-gray-500">
    <p>These interests help us personalize your experience and connect you with like-minded users.</p>
    <p class="mt-2">You can always update these preferences later from your profile settings.</p>
  </div>
</div>
